<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="http://185.60.40.210/2daw3/FuncionesJuegos.js"></script>


    <script>
        var contador = 0;
        var carta1 = undefined;
        var carta2 = undefined;
        var check1 = [];
        var check2 = [];
        var id1;
        var id2;
        // do {
        //     var cartas = parseInt(prompt("Introduzca las cartas deseadas para el juego entre 1 y 20 "), 10);
        //     if (cartas > 21 || cartas < 0) {
        //         alert("el numero introducicdo no es valido");
        //         cartas = "f";
        //     }
        // } while (isNaN(cartas));

        // Number(cartas);

        // do {
        //     var palos = parseInt(prompt("Introduzca las cartas deseadas para el juego entre 1 y 20 "), 10);
        //     if (palos > 21 || palos < 0) {
        //         alert("el numero introducicdo no es valido");
        //         palos = "f";
        //     }
        // } while (isNaN(palos));

        // Number(palos);
        cartas = 2;
        palos = 10;

        baraja = CrearTablaCartas(cartas, palos)


        const N = cartas;
        const M = palos;
        var aEstado = ("1").repeat(N).split("").map(() => new Array(M).fill(false))


        document.write("<table  id='table' border='1' style='border-collapse: collapse'>");
        for (let j = 0; j < baraja.length; j++) {
            document.write("<tr>");
            for (let i = 0; i < baraja[j].length; i++) {
                document.write(`<th><img id="carta${j}${i}"src="images/0.png" onclick="swap(this,${j},${i})"></th>`);
            }
            document.write("</tr>")
        }
        document.write("</table>");

        function swap(object, j, i) {
            contador = contador + 1
            carta = baraja[j][i]

            document.getElementById(object.id).src = `images/${carta}.png`
            if (carta1 === undefined) {
                carta1 = carta
                check1[0] = j;
                check1[1] = i;

                id1 = object.id;

            } else {
                carta2 = carta;
                check2[0] = j;
                check2[1] = i;
                id2 = object.id;
            }

            if (contador == 2) {
                check()
            }


        }

        function check() {
            if (carta1 == carta2) {

                aEstado[check1[0]][check1[1]] = true;
                aEstado[check2[0]][check2[1]] = true;
                //(carta1)
                carta1 = undefined;
                //alert(carta1)
                carta2 = undefined;
                contador = 0;
                terminar()
            } else {
                document.getElementById('table').style = "pointer-events:none;"
                setTimeout(() => {

                    document.getElementById(id1).src = "images/0.png";
                    document.getElementById(id2).src = "images/0.png";
                    //alert(carta1)
                    carta1 = undefined;
                    //alert(carta1)
                    carta2 = undefined;
                    contador = 0;
                    document.getElementById('table').style = "pointer-events:auto;"
                }, 1000)

            }
        }

        function terminar() {
            let bTerminado = true;
            for (let i = 0; i < cartas; i++) {
                for (let j = 0; j < palos; j++) {
                    bTerminado = bTerminado && aEstado[i][j]
                }
            }

            if(bTerminado){
            alert("Felicidades has terminado el juego")
            }


        }


    </script>
</head>

<body>

</body>

</html>